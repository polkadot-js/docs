"use strict";(self.webpackChunkpolkadot_js=self.webpackChunkpolkadot_js||[]).push([[897],{4137:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return f}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),m=i,f=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return n?a.createElement(f,r(r({ref:t},c),{},{components:n})):a.createElement(f,r({ref:t},c))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:i,r[1]=l;for(var u=2;u<o;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9657:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return f},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var a=n(7462),i=n(3366),o=(n(7294),n(4137)),r=["components"],l={title:"FAQ"},s=void 0,u={unversionedId:"util-crypto/FAQ",id:"util-crypto/FAQ",title:"FAQ",description:"The list will be updated/expanded as questions come up, dealing with some common issues that util-crypto users find.",source:"@site/docs/util-crypto/FAQ.md",sourceDirName:"util-crypto",slug:"/util-crypto/FAQ",permalink:"/docs/util-crypto/FAQ",draft:!1,editUrl:"https://github.com/polkadot-js/docs/edit/master/docs/util-crypto/FAQ.md",tags:[],version:"current",frontMatter:{title:"FAQ"},sidebar:"reference",previous:{title:"Hash Data",permalink:"/docs/util-crypto/examples/hash-data"},next:{title:"Overview",permalink:"/docs/api-contract"}},c={},p=[{value:"I am having trouble initializing the wasm interface",id:"i-am-having-trouble-initializing-the-wasm-interface",level:2},{value:"My React Native build runs out of memory",id:"my-react-native-build-runs-out-of-memory",level:2},{value:"I don&#39;t have WASM available in my environment",id:"i-dont-have-wasm-available-in-my-environment",level:2}],d={toc:p},m="wrapper";function f(e){var t=e.components,n=(0,i.Z)(e,r);return(0,o.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The list will be updated/expanded as questions come up, dealing with some common issues that util-crypto users find."),(0,o.kt)("h2",{id:"i-am-having-trouble-initializing-the-wasm-interface"},"I am having trouble initializing the wasm interface"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"@polkadot/util-crypto"),' libraries has a WASM backend but has JS fallbacks in place for most operations. This means that when the WASM has been initialized it will be used, alternatively the JS fallbacks will be utilized. Some interfaces, such as using sr25519 however are only available via WASM. When trying to use these without a completed initialization and error such as "The WASM interface has not been initialized. Ensure that you wait for the initialization Promise before attempting to use WASM-only interfaces." will be thrown.'),(0,o.kt)("p",null,"When using an import/require from the library the WASM async init will be automatically started. Due to the async nature of this process (which is also started automatically in the API) it may not have been completed before attempting to use. In these cases always use a ",(0,o.kt)("inlineCode",{parentName:"p"},"await cryptoWaitReady()")," before attempting interfaces that required WASM."),(0,o.kt)("h2",{id:"my-react-native-build-runs-out-of-memory"},"My React Native build runs out of memory"),(0,o.kt)("p",null,"When using the util-crypto packages with RN, due to a lack of support, an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/polkadot-js/wasm/issues/19"},"asm.js fallback")," is provided since (most) React Native implementations does not have a native WASM executor."),(0,o.kt)("p",null,"While the fallback is fully tested and equivalent to the WASM version, it does add some memory load to the application build process. Additionally simnce the asm.js bundle is quite large, the build process is by no means fast. Ensure that you adjust your build flags to include ",(0,o.kt)("inlineCode",{parentName:"p"},"NODE_OPTIONS=--max_old_space_size=8192"),", for instance doing ",(0,o.kt)("inlineCode",{parentName:"p"},"NODE_OPTIONS=--max_old_space_size=8192 yarn run ios")),(0,o.kt)("h2",{id:"i-dont-have-wasm-available-in-my-environment"},"I don't have WASM available in my environment"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"util-crypto")," package relies on ",(0,o.kt)("inlineCode",{parentName:"p"},"wasm-crypto")," to provide faster interfaces with JS fallbacks where WASM is not available. In some cases such as sr25519, only WASM interfaces are available, so it will not be operational without."),(0,o.kt)("p",null,"For some environments (Java -> JS bindings, React Native, etc.) WASM may not be available at all. To cater for these, an asm.js interface is also provided. Due to the size it adds to any bundler, it is not enabled by default, so does require specific initilization to be used."),(0,o.kt)("p",null,"If you are upgrading from ",(0,o.kt)("inlineCode",{parentName:"p"},"@polkadot/wasm-crypto")," prior to 5.0.1 or ",(0,o.kt)("inlineCode",{parentName:"p"},"@polkadot/util-crypto")," prior to 8.6.1 the above replaces any overrides and aliases that you may have added to your bundler. Additionally, for RN enviroments, this step is now required, where previously react-native defaulted to injecting asm.js."),(0,o.kt)("p",null,"And example of initialization to use no WASM and only asm.js is provided here -"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// important this needs to be done before any `@polkadot/util-crypto` operations, if not\n// applied, the environment will use the `initOnlyWasm` interface by default\nimport '@polkadot/wasm-crypto/initOnlyAsm';\n")),(0,o.kt)("p",null,"In the same vein, if you would like to use WASM by default with an asm.js fallback, the following initialization option can be used -"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// important this needs to be done before any `@polkadot/util-crypto` operations\nimport '@polkadot/wasm-crypto/initWasmAsm';\n")))}f.isMDXComponent=!0}}]);